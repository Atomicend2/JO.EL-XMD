const _0x89c256=_0x545d;(function(_0x5e6e04,_0x537383){const _0x4837b4=_0x545d,_0x5351c7=_0x5e6e04();while(!![]){try{const _0x3c8e21=parseInt(_0x4837b4(0x1ad))/0x1*(-parseInt(_0x4837b4(0x19f))/0x2)+-parseInt(_0x4837b4(0x19a))/0x3+parseInt(_0x4837b4(0x1a2))/0x4+-parseInt(_0x4837b4(0x191))/0x5+parseInt(_0x4837b4(0x1a6))/0x6*(-parseInt(_0x4837b4(0x1a9))/0x7)+-parseInt(_0x4837b4(0x1c0))/0x8*(parseInt(_0x4837b4(0x1a1))/0x9)+parseInt(_0x4837b4(0x19b))/0xa*(parseInt(_0x4837b4(0x1b5))/0xb);if(_0x3c8e21===_0x537383)break;else _0x5351c7['push'](_0x5351c7['shift']());}catch(_0x57df3f){_0x5351c7['push'](_0x5351c7['shift']());}}}(_0x34e2,0xb2680));import{promises as _0x4abf89}from'fs';function _0x545d(_0x23ba6e,_0x30b39c){const _0x34e2f3=_0x34e2();return _0x545d=function(_0x545d70,_0xf34c31){_0x545d70=_0x545d70-0x184;let _0x50235a=_0x34e2f3[_0x545d70];return _0x50235a;},_0x545d(_0x23ba6e,_0x30b39c);}import _0xc4f087 from'path';import _0x28cda4 from'node-fetch';import _0x2cb8a0 from'@whiskeysockets/baileys';const {generateWAMessageFromContent,proto}=_0x2cb8a0;import _0x1322f4 from'../../config.cjs';function _0x34e2(){const _0x1ba04f=['Error\x20writing\x20chat\x20history\x20to\x20file:','resolve','status','length','parse','push','toLowerCase','https://matrixcoder.tech/api/ai','copy_code','sendMessage','1682805clrPec','user','shift','Body','split','NativeFlowMessage','stringify','url','Please\x20give\x20me\x20a\x20prompt','286638opuYDq','2050rbwmtn','hf/meta-llama/meta-llama-3-8b-instruct','slice','from','6HUQnti','you\x20are\x20a\x20good\x20assistant.','1661643vPyqRl','4592544SRvCZD','POST','Header','>\x20¬©\x20·¥ò·¥è·¥°·¥á Ä·¥á·¥Ö\x20 ô è\x20ùôπùôæùöéùöï','1623918tnhlLX','mistral','dirname','7MBBTme','HTTP\x20error!\x20status:\x20','Conversation\x20deleted\x20successfully','body','117144IgUQkK','assistant','error','key','Something\x20went\x20wrong','React','Footer','../mistral_history.json','44077tfWPsp','response','InteractiveMessage','includes','/forget','PREFIX','application/json','sender','utf-8','system','create','8eGmnjc','remoteJid','gpt','writeFile','readFile','match','Message'];_0x34e2=function(){return _0x1ba04f;};return _0x34e2();}const __filename=new URL(import.meta[_0x89c256(0x198)])['pathname'],__dirname=_0xc4f087[_0x89c256(0x1a8)](__filename),chatHistoryFile=_0xc4f087[_0x89c256(0x188)](__dirname,_0x89c256(0x1b4)),mistralSystemPrompt=_0x89c256(0x1a0);async function readChatHistoryFromFile(){const _0x4850ed=_0x89c256;try{const _0x230148=await _0x4abf89[_0x4850ed(0x184)](chatHistoryFile,_0x4850ed(0x1bd));return JSON[_0x4850ed(0x18b)](_0x230148);}catch(_0x34779d){return{};}}async function writeChatHistoryToFile(_0x1a0af9){const _0x540aec=_0x89c256;try{await _0x4abf89[_0x540aec(0x1c3)](chatHistoryFile,JSON[_0x540aec(0x197)](_0x1a0af9,null,0x2));}catch(_0x558d66){console['error'](_0x540aec(0x187),_0x558d66);}}async function updateChatHistory(_0x2487e8,_0x37bd59,_0x5a0be7){const _0x25e048=_0x89c256;!_0x2487e8[_0x37bd59]&&(_0x2487e8[_0x37bd59]=[]),_0x2487e8[_0x37bd59][_0x25e048(0x18c)](_0x5a0be7),_0x2487e8[_0x37bd59][_0x25e048(0x18a)]>0x14&&_0x2487e8[_0x37bd59][_0x25e048(0x193)](),await writeChatHistoryToFile(_0x2487e8);}async function deleteChatHistory(_0x56398d,_0xf8ba2b){delete _0x56398d[_0xf8ba2b],await writeChatHistoryToFile(_0x56398d);}const mistral=async(_0x11a888,_0x4af640)=>{const _0x2faafe=_0x89c256,_0x46342f=await readChatHistoryFromFile(),_0x2f37d5=_0x11a888[_0x2faafe(0x1ac)][_0x2faafe(0x18d)]();if(_0x2f37d5===_0x2faafe(0x1b9)){await deleteChatHistory(_0x46342f,_0x11a888[_0x2faafe(0x1bc)]),await _0x4af640[_0x2faafe(0x190)](_0x11a888[_0x2faafe(0x19e)],{'text':_0x2faafe(0x1ab)},{'quoted':_0x11a888});return;}const _0x5296a0=_0x1322f4[_0x2faafe(0x1ba)],_0x29c250=_0x11a888[_0x2faafe(0x1ac)]['startsWith'](_0x5296a0)?_0x11a888['body'][_0x2faafe(0x19d)](_0x5296a0[_0x2faafe(0x18a)])[_0x2faafe(0x195)]('\x20')[0x0][_0x2faafe(0x18d)]():'',_0x11df64=_0x11a888[_0x2faafe(0x1ac)][_0x2faafe(0x19d)](_0x5296a0[_0x2faafe(0x18a)]+_0x29c250['length'])['trim'](),_0x31086d=['ai',_0x2faafe(0x1c2),_0x2faafe(0x1a7)];if(_0x31086d[_0x2faafe(0x1b8)](_0x29c250)){if(!_0x11df64){await _0x4af640[_0x2faafe(0x190)](_0x11a888[_0x2faafe(0x19e)],{'text':_0x2faafe(0x199)},{'quoted':_0x11a888});return;}try{const _0x1cc4ce=_0x46342f[_0x11a888[_0x2faafe(0x1bc)]]||[],_0x5249f2=[{'role':_0x2faafe(0x1be),'content':mistralSystemPrompt},..._0x1cc4ce,{'role':_0x2faafe(0x192),'content':_0x11df64}];await _0x11a888[_0x2faafe(0x1b2)]('‚è≥');const _0x448096=await _0x28cda4(_0x2faafe(0x18e),{'method':_0x2faafe(0x1a3),'headers':{'Content-Type':_0x2faafe(0x1bb)},'body':JSON[_0x2faafe(0x197)]({'type':'text-generation','model':_0x2faafe(0x19c),'messages':_0x5249f2})});if(!_0x448096['ok'])throw new Error(_0x2faafe(0x1aa)+_0x448096[_0x2faafe(0x189)]);const _0x2cc206=await _0x448096['json']();await updateChatHistory(_0x46342f,_0x11a888[_0x2faafe(0x1bc)],{'role':'user','content':_0x11df64}),await updateChatHistory(_0x46342f,_0x11a888[_0x2faafe(0x1bc)],{'role':_0x2faafe(0x1ae),'content':_0x2cc206['result'][_0x2faafe(0x1b6)]});const _0x5c0aed=_0x2cc206['result'][_0x2faafe(0x1b6)],_0xda3893=_0x5c0aed[_0x2faafe(0x185)](/```([\s\S]*?)```/);if(_0xda3893){const _0x5ccf1e=_0xda3893[0x1];let _0x4ef941=generateWAMessageFromContent(_0x11a888[_0x2faafe(0x19e)],{'viewOnceMessage':{'message':{'messageContextInfo':{'deviceListMetadata':{},'deviceListMetadataVersion':0x2},'interactiveMessage':proto[_0x2faafe(0x186)][_0x2faafe(0x1b7)][_0x2faafe(0x1bf)]({'body':proto[_0x2faafe(0x186)][_0x2faafe(0x1b7)][_0x2faafe(0x194)][_0x2faafe(0x1bf)]({'text':_0x5c0aed}),'footer':proto['Message']['InteractiveMessage'][_0x2faafe(0x1b3)]['create']({'text':_0x2faafe(0x1a5)}),'header':proto['Message'][_0x2faafe(0x1b7)][_0x2faafe(0x1a4)][_0x2faafe(0x1bf)]({'title':'','subtitle':'','hasMediaAttachment':![]}),'nativeFlowMessage':proto[_0x2faafe(0x186)][_0x2faafe(0x1b7)][_0x2faafe(0x196)][_0x2faafe(0x1bf)]({'buttons':[{'name':'cta_copy','buttonParamsJson':JSON[_0x2faafe(0x197)]({'display_text':'Copy\x20Your\x20Code','id':_0x2faafe(0x18f),'copy_code':_0x5ccf1e})}]})})}}},{});await _0x4af640['relayMessage'](_0x4ef941[_0x2faafe(0x1b0)][_0x2faafe(0x1c1)],_0x4ef941['message'],{'messageId':_0x4ef941['key']['id']});}else await _0x4af640['sendMessage'](_0x11a888[_0x2faafe(0x19e)],{'text':_0x5c0aed},{'quoted':_0x11a888});await _0x11a888['React']('‚úÖ');}catch(_0x11aa0c){await _0x4af640['sendMessage'](_0x11a888[_0x2faafe(0x19e)],{'text':_0x2faafe(0x1b1)},{'quoted':_0x11a888}),console[_0x2faafe(0x1af)]('Error:\x20',_0x11aa0c),await _0x11a888[_0x2faafe(0x1b2)]('‚ùå');}}};export default mistral;